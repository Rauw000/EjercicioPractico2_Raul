<!DOCTYPE html><html xmlns:th="http://www.thymeleaf.org"><head><meta charset="UTF-8"><title>Consultas</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"></head>
    <body><div class="container mt-4">
            <h3>Consultas avanzadas</h3>
            <form class="row g-2" method="get" action="#" th:action="@{/admin/consultas}">
                <div class="col-md-3">
                    <select name="rol" class="form-select">
                        <option value="">-- Filtrar por rol --</option>
                        <option th:each="r : ${roles}" th:value="${r.nombre}" th:text="${r.nombre}"></option>
                    </select>
                </div>
                <div class="col-md-3">
                    <input name="q" placeholder="buscar nombre/email" class="form-control"/>
                </div>
                <div class="col-md-3">
                    <input name="start" placeholder="2025-01-01T00:00:00" class="form-control"/>
                </div>
                <div class="col-md-3">
                    <input name="end" placeholder="2025-12-31T23:59:59" class="form-control"/>
                </div>
                <div class="col-12"><button class="btn btn-primary mt-2">Buscar</button></div>
            </form>

            <div class="mt-3">
                <p>Activos: <strong th:text="${countActive}"></strong> | Inactivos: <strong th:text="${countInactive}"></strong></p>
            </div>

            <table class="table table-striped mt-2"><thead><tr><th>ID</th><th>Usuario</th><th>Nombre</th><th>Rol</th><th>Creado</th></tr></thead>
                <tbody><tr th:each="u : ${resultados}">
                        <td th:text="${u.id}"></td>
                        <td th:text="${u.username}"></td>
                        <td th:text="${u.nombre} + ' ' + ${u.apellido}"></td>
                        <td th:text="${u.role != null ? u.role.nombre : 'N/A'}"></td>
                        <td th:text="${u.createdAt}"></td>
                    </tr></tbody>
            </table>
        </div></body></html>
